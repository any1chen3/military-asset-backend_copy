# 军工资产管理系统完整接口清单 （1119更新）

## 📥 Excel导入接口（POST请求）

| 名称         | 路径                             | 功能                     |
| ------------ | -------------------------------- | ------------------------ |
| 软件资产导入 | `/api/asset/import/software`     | 批量导入软件应用资产数据 |
| 网信资产导入 | `/api/asset/import/cyber`        | 批量导入网信基础资产数据 |
| 数据资产导入 | `/api/asset/import/data-content` | 批量导入数据内容资产数据 |

## 📤 Excel导出接口

### 统一导出接口（POST请求）

| 名称             | 路径                         | 功能                                                         |
| :--------------- | :--------------------------- | :----------------------------------------------------------- |
| 软件资产统一导出 | `/api/asset/export/software` | 根据查询条件导出软件资产数据，支持全部导出、条件导出和分页导出三种模式 |
| 网信资产统一导出 | `/api/asset/export/cyber`    | 根据查询条件导出网信资产数据，支持全部导出、条件导出和分页导出三种模式 |
| 数据资产统一导出 | `/api/asset/export/data`     | 根据查询条件导出数据资产数据，支持全部导出、条件导出和分页导出三种模式 |

**导出逻辑说明：**

- **无查询条件** → 导出全部数据
- **有查询条件+无分页** → 导出全部匹配数据
- **有查询条件+有分页** → 导出当前页数据

**其他说明**：

- 导出文件需自己命名 、第一行是各表的列标题   、第二行开始是数据
- 接口参数同联合查询一致，可查看CyberQueryVO、DataContentQueryVO、SoftwareQueryVO

## 🔍 查询接口（GET请求）

### （1）软件应用资产表接口

| 名称                 | 路径                                                         | 功能                         |
| -------------------- | ------------------------------------------------------------ | ---------------------------- |
| 软件资产详情         | `/api/asset/software/{id}`                                   | 根据ID查询软件资产详细信息   |
| 软件资产联合查询     | `/api/asset/software/combined-query`                         | 多条件组合查询软件资产       |
| 软件资产取得方式统计 | `/api/asset/software/statistics/v2/acquisition`              | 统计软件资产取得方式分布     |
| 软件资产服务状态统计 | `/api/asset/software/statistics/v2/service-status`           | 统计软件资产服务状态分布     |
| 软件资产省份老化统计 | `/api/asset/software/statistics/v2/aging/province`           | 统计各省份软件资产老化情况   |
| 软件资产升级判定     | `/api/asset/software/statistics/v2/aging/asset/{assetId}/upgrade-required` | 判定指定软件资产是否需要升级 |

### （2）网信基础资产表接口

| 名称             | 路径                              | 功能                       |
| ---------------- | --------------------------------- | -------------------------- |
| 网信资产详情     | `/api/asset/cyber/{id}`           | 根据ID查询网信资产详细信息 |
| 网信资产联合查询 | `/api/asset/cyber/combined-query` | 多条件组合查询网信基础资产 |

### （3）数据内容资产表接口

| 名称               | 路径                                          | 功能                         |
| ------------------ | --------------------------------------------- | ---------------------------- |
| 数据资产详情       | `/api/asset/data/{id}`                        | 根据ID查询数据资产详细信息   |
| 数据资产联合查询   | `/api/asset/data/combined-query`              | 多条件组合查询数据内容资产   |
| 数据资产信息化程度 | `/api/asset/data/province/information-degree` | 计算各省份数据资产信息化程度 |
| 数据资产国产化率   | `/api/asset/data/province/domestic-rate`      | 计算各省份数据资产国产化率   |

## 📊 额外查询接口（GET请求）

### a) 接口1：数据量统计

| 名称               | 路径                          | 功能                             |
| ------------------ | ----------------------------- | -------------------------------- |
| 三类资产数据量统计 | `/api/asset/statistics/count` | 分别统计三类资产的数据量（行数） |

### b) 接口2：按资产信息分类

| 名称                 | 路径                                 | 功能                             |
| -------------------- | ------------------------------------ | -------------------------------- |
| 软件资产分类查询     | `/api/asset/software/category-query` | 按分类编码或资产分类筛选软件资产 |
| 网信资产分类查询     | `/api/asset/cyber/category-query`    | 按分类编码或资产分类筛选网信资产 |
| 数据资产应用领域查询 | `/api/asset/data/field-query`        | 按应用领域筛选数据内容资产       |

### c) 接口3：按上报单位查询

| 名称               | 路径                              | 功能                                   |
| ------------------ | --------------------------------- | -------------------------------------- |
| 软件资产按单位查询 | `/api/asset/software/unit-assets` | 查询指定上报单位的软件资产             |
| 网信资产按单位查询 | `/api/asset/cyber/unit-assets`    | 查询指定上报单位的网信资产             |
| 数据资产按单位查询 | `/api/asset/data/unit-assets`     | 查询指定上报单位的数据资产             |
| 上报单位列表       | `/api/asset/report-units`         | 获取上报单位列表，支持按资产表类型筛选 |

### d) 接口4：上报单位对应的省份统计

| 名称                      | 路径                               | 功能                                     |
| ------------------------- | ---------------------------------- | ---------------------------------------- |
| 各省份单位统计-在各资产下 | `/api/asset/province/asset-tables` | 分别统计三个资产表中各省份的上报单位数量 |
| 各省份单位统计-在全资产下 | `/api/asset/province/report-units` | 统计各省份有数据的单位总数（去重）       |

### e) 接口5：固定选项下拉菜单

| 名称                 | 路径                                | 功能                             |
| -------------------- | ----------------------------------- | -------------------------------- |
| 数据内容资产固定选项 | `/api/asset/data/fixed-options`     | 获取数据内容资产表的下拉菜单数据 |
| 软件应用资产固定选项 | `/api/asset/software/fixed-options` | 获取软件应用资产表的下拉菜单数据 |
| 网信基础资产固定选项 | `/api/asset/cyber/fixed-options`    | 获取网信基础资产表的下拉菜单数据 |

### f) 接口6：省份资产统计接口

| 名称                             | 路径                                            | 功能                                                         |
| -------------------------------- | ----------------------------------------------- | ------------------------------------------------------------ |
| 按省份统计三类资产数量和百分比   | `/api/asset/statistics/province-asset-overview` | 统计34个省份+"未知"的三类资产数量及占比，返回各省份软件、网信、数据资产的数量和百分比 |
| 按省份和资产类型统计资产分类细分 | `/api/asset/statistics/province-asset-detail`   | 统计指定省份下指定资产类型的各资产分类数量和占比，返回完整的固定分类列表（包括数量为0的分类） |

**接口6详细说明：**

- **province-asset-overview**: 返回各省份三类资产的完整分布情况，包含总数和百分比
- **province-asset-detail**: 
  - 参数：`province`(必填), `assetType`(必填: software/cyber/data)
  - 返回：该省份指定资产类型下所有固定分类的完整统计，确保前端获得一致的数据结构

## ➕ 新增接口（POST请求）

| 名称         | 路径                  | 功能                                                         |
| ------------ | --------------------- | ------------------------------------------------------------ |
| 新增软件资产 | `/api/asset/software` | 新增单个软件资产，包含完整数据校验、金额计算和上报单位表同步 |
| 新增网信资产 | `/api/asset/cyber`    | 新增单个网信资产，包含省市自动填充、数据校验和状态同步       |
| 新增数据资产 | `/api/asset/data`     | 新增单个数据资产，包含固定选项校验、省市填充和状态同步       |

## ✏️ 修改接口（PUT请求）

| 名称         | 路径                  | 功能                                                         |
| ------------ | --------------------- | ------------------------------------------------------------ |
| 修改软件资产 | `/api/asset/software` | 修改软件资产信息，包含数据存在性校验、完整数据校验、金额自动重算、创建时间更新、上报单位变更的双向同步 |
| 修改网信资产 | `/api/asset/cyber`    | 修改网信资产信息，包含数据存在性校验、省市智能自动填充、完整数据校验、上报单位变更时的智能省市重新推导和双向同步 |
| 修改数据资产 | `/api/asset/data`     | 修改数据资产信息，包含数据存在性校验、固定选项校验、省市自动填充、创建时间更新和上报单位同步 |

## 🗑️ 删除接口（DELETE请求）

| 名称         | 路径                       | 功能                                                         |
| ------------ | -------------------------- | ------------------------------------------------------------ |
| 删除软件资产 | `/api/asset/software/{id}` | 删除指定软件资产，包含数据存在性校验、物理删除和自动同步上报单位表状态 |
| 删除网信资产 | `/api/asset/cyber/{id}`    | 删除指定网信资产，包含数据存在性校验、物理删除和自动同步上报单位表状态 |
| 删除数据资产 | `/api/asset/data/{id}`     | 删除指定数据资产，包含数据存在性校验、物理删除和自动同步上报单位表状态 |

## 🎯 增删改接口特性说明

### **修改接口完整功能说明**

#### **核心处理流程**

1. **数据存在性校验** - 验证要修改的记录是否存在
2. **上报单位变更判断** - 比较新旧上报单位，确定同步策略
3. **省市自动填充** - 根据上报单位智能推导省市信息
4. **完整数据校验** - 执行与新增相同的严格数据验证
5. **业务数据处理** - 金额重算、时间更新等
6. **数据持久化** - 执行数据库更新操作
7. **状态同步** - 维护上报单位表的状态标志

#### **智能省市填充逻辑**

- **上报单位变更** → 强制重新推导省市信息
- **上报单位不变** → 尊重现有省市值，仅在空值时自动填充
- **软件资产** - 无省市字段，不处理省市信息
- **网信/数据资产** - 支持省市信息的智能维护

#### **上报单位变更同步策略**

- **单位未变更** - 只同步当前单位状态
- **单位已变更** - 双向同步新旧两个单位状态
  - 原单位：设置为删除状态（可能不再有数据）
  - 新单位：设置为新增状态（确认有数据）

#### **数据校验规则**

- **主键校验**：必填，确保存在性
- **上报单位校验**：必填，支持变更处理
- **分类编码匹配**：必填，与资产分类严格对应
- **数量金额校验**：非负整数，支持范围约束
- **固定选项校验**：严格匹配预设选项值
- **日期范围校验**：1949年至今的有效日期
- **业务逻辑校验**：已用数量≤实有数量等

#### **事务安全保障**

- @Transactional注解确保操作原子性
- 任何步骤失败都会回滚整个事务
- 详细的异常处理和日志记录

### **数据校验规则详情**

#### **软件资产校验字段**

1. 上报单位（必填）
2. 分类编码与资产分类（必填，严格匹配）
3. 资产名称（必填）
4. 取得方式（必填，固定选项）
5. 部署范围（必填，固定选项）
6. 部署形式（可选，非空约束）
7. 承载网络（可选，非空约束）
8. 实有数量（必填，非负整数）
9. 计量单位（必填）
10. 单价（可选，非负约束）
11. 服务状态（必填，固定选项）
12. 投入使用日期（必填，日期范围）
13. 盘点单位（必填）

#### **网信资产校验字段**

1. 主键（必填，存在性）
2. 上报单位（必填）
3. 分类编码与资产分类（必填，严格匹配）
4. 资产名称（必填）
5. 资产内容（必填）
6. 实有数量（必填，非负整数）
7. 计量单位（必填）
8. 单价（可选，非负约束）
9. 投入使用日期（必填，日期范围）
10. 已用数量（必填，≤实有数量）
11. 盘点单位（必填）

#### **数据资产校验字段**

1. 主键（必填，存在性）
2. 上报单位（必填）
3. 分类编码与资产分类（必填，严格匹配）
4. 资产名称（必填）
5. 应用领域（必填，固定选项）
6. 开发工具（必填，固定选项）
7. 实有数量（必填，非负整数）
8. 计量单位（必填）
9. 单价（可选，非负约束）
10. 更新周期（必填，固定选项）
11. 更新方式（必填，固定选项）
12. 盘点单位（必填）

### **上报单位同步逻辑**

- **新增操作**：标记该单位在对应资产表有数据
- **修改操作**：支持上报单位变更的双向同步
- **删除操作**：检查剩余数据量，自动更新状态标志
- **状态独立**：各资产表状态完全独立管理
- **实时刷新**：每次操作都重新检查所有资产表状态

---

## 🎯 接口统计

- **总计接口数量**：**39个**
- **Excel导入接口**：3个
- **Excel导出接口**：3个
- **查询统计接口**：**25个**
- **增删改接口**：9个
- **已完成接口**：**40个**
- **待确认接口**：0个

所有接口均采用统一返回格式，支持分页机制（每页最大50条），为前端提供完整的数据管理能力。

## 🔄 更新日志

- **2025-11-19：**✅ **新增省份资产统计接口**
  - 新增2个省份资产统计接口
  - 实现34个省份+"未知"的完整资产分布统计
  - 支持三类资产的数量和百分比统计
  - 提供完整的资产分类细分统计
  - 确保返回所有固定分类列表（包括数量为0的分类）
- **2025-11-18：**✅ 完成所有增删改接口开发**
  - 新增3个新增接口（POST）
  - 新增3个修改接口（PUT） 
  - 新增3个删除接口（DELETE）
  - 实现完整的数据校验和状态同步
  - 支持上报单位变更的智能省市推导
  - 完善修改接口的完整功能说明
- **2025-11-17**：重构导出接口，统一为3个POST接口，支持动态查询和分页导出
- **2025-11-03**：初始版本，包含基础CRUD和查询统计接口

## 🚀 系统状态

**✅ 所有核心功能开发完成**

- Excel导入导出功能 ✓
- 多条件联合查询 ✓  
- 统计分析报表 ✓
- 完整增删改操作 ✓
- 上报单位状态同步 ✓
- 省市自动填充 ✓
- 完整数据校验 ✓
- 事务安全保障 ✓
- **省份资产统计** ✓

系统现已具备完整的资产管理能力，支持从数据录入、查询统计到维护管理的全生命周期管理，新增的省份资产统计接口为区域分析提供了强大的数据支持。
